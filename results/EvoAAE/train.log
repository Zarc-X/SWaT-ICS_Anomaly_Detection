================================================================================
EvoAAE - 在SWaT数据集上进行异常检测
================================================================================
加载数据...
正常数据形状 (不含标签): (99360, 51)
攻击数据形状 (不含标签): (89984, 51)
正常数据标签分布: {0: 99360}
攻击数据标签分布: {0: 79053, 1: 10931}

特征数量: 51
训练集大小: (99360, 51)
测试集大小: (89984, 51)

================================================================================
初始化EvoAAE模型...
================================================================================

开始训练模型...
这可能需要一些时间，请耐心等待...
============================================================
开始训练EvoAAE模型（仅用正常数据）
============================================================

1. 预处理正常数据...
数据验证...
  数据范围: [0.000000, 2.000000]
  数据均值: 0.905532, 标准差: 0.509472
归一化数据...
  归一化后范围: [-12.449143, 31.703657]
  归一化后均值: -0.000000, 标准差: 0.885615
应用滑动窗口切分 (窗口大小=100, 步长=20)...
原始数据形状: (99360, 51)
处理后窗口形状: (4964, 100, 51)
窗口数据范围: [-12.449143, 31.703657]
训练集和验证集已准备
  训练集: 3971 个窗口
  验证集: 993 个窗口

预处理异常数据...
数据验证...
  数据范围: [0.000000, 2.000000]
  数据均值: 0.867575, 标准差: 0.523412
归一化数据...
  归一化后范围: [-22.005583, 90.439835]
  归一化后均值: 0.000000, 标准差: 0.928841
应用滑动窗口切分 (窗口大小=100, 步长=20)...
原始数据形状: (89984, 51)
处理后窗口形状: (4495, 100, 51)
窗口数据范围: [-22.005583, 90.439835]
异常数据已预处理: 4495 个窗口

2. PSO超参数优化...
总编码长度: 16 位
  batch_size: 2 位 (4 个选项)
  learning_rate: 2 位 (4 个选项)
  optimizer: 2 位 (4 个选项)
  n_layers: 2 位 (4 个选项)
  n_kernels: 3 位 (8 个选项)
  kernel_size: 2 位 (4 个选项)
  normalization: 1 位 (2 个选项)
  activation: 2 位 (4 个选项)
开始二进制PSO优化，种群大小: 15, 最大迭代次数: 20
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
警告: 编码器梯度范数=10.29, 解码器梯度范数=0.48
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
迭代 5/20 - 最佳适应度: 1.916098
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
警告: 编码器梯度范数=48.91, 解码器梯度范数=0.90
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
迭代 10/20 - 最佳适应度: 1.764864
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
迭代 15/20 - 最佳适应度: 1.764864
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
警告: 编码器梯度范数=33.07, 解码器梯度范数=2.13
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
警告: 编码器梯度范数=35.36, 解码器梯度范数=1.07
迭代 20/20 - 最佳适应度: 1.764864
优化完成！最佳适应度: 1.764864
最佳参数配置:
  batch_size: 1024
  learning_rate: 0.005
  optimizer: adadelta
  n_layers: 4
  n_kernels: 128
  kernel_size: 4
  normalization: batchnorm
  activation: sigmoid

3. 使用最佳参数训练最终模型...
最终模型配置:
  - 批量大小: 125
  - 学习率: 0.005
  - 优化器: adadelta
  - 卷积层数: 4
  - 每层卷积核数: 128
  - 卷积核大小: 4
  - 归一化: batchnorm
  - 激活函数: sigmoid
训练数据统计: min=-12.4491, max=31.7037, mean=0.0002, std=0.8869
[预热阶段] Epoch 1 - 学习率: 0.000100
[预热阶段] Epoch 2 - 学习率: 0.000200
[预热阶段] Epoch 3 - 学习率: 0.000300
[预热阶段] Epoch 4 - 学习率: 0.000400
[预热阶段] Epoch 5 - 学习率: 0.000500
Epoch 10/50 - loss: 1.2197 - val_loss: 0.9991
Epoch 20/50 - loss: 1.1500 - val_loss: 0.8230
Epoch 30/50 - loss: 1.1415 - val_loss: 0.8202
Epoch 40/50 - loss: 1.1298 - val_loss: 0.8064
Epoch 50/50 - loss: 1.1448 - val_loss: 0.8070

训练完成！

4. 计算异常检测阈值...
   使用验证集（正常数据）的重建误差来设定阈值...
阈值已计算: 5.531523
   (90%分位: 0.992751, 均值+3σ: 5.531523)
   验证集重建误差统计:
     - 最小值: 0.121831
     - 最大值: 37.936569
     - 平均值: 0.710220
     - 中位数: 0.450087
     - 90%ile: 0.992751

================================================================================
在测试集上评估模型...
================================================================================
原始测试集大小: 89984
窗口化后测试集大小: 4495
检测结果长度: 4495
评估结果:
  - Precision: 0.9972
  - Recall: 0.5050
  - F1-Score: 0.6704
  - 检测到的异常: 357/705

生成可视化结果...
结果图已保存到: /root/autodl-tmp/SWaT-ICS_Anomaly_Detection/results/EvoAAE/evoaae_swat_results.png

================================================================================
保存中间结果和模型信息...
================================================================================
 训练数据已保存到: /root/autodl-tmp/SWaT-ICS_Anomaly_Detection/results/EvoAAE/preprocessed_data/train_data.npz
 测试数据已保存到: /root/autodl-tmp/SWaT-ICS_Anomaly_Detection/results/EvoAAE/preprocessed_data/test_data.npz
 原始测试标签已保存到: /root/autodl-tmp/SWaT-ICS_Anomaly_Detection/results/EvoAAE/preprocessed_data/test_labels_original.npz
 训练历史已保存到: /root/autodl-tmp/SWaT-ICS_Anomaly_Detection/results/EvoAAE/training_history/history.json
 训练历史CSV已保存到: /root/autodl-tmp/SWaT-ICS_Anomaly_Detection/results/EvoAAE/training_history/history.csv
 异常检测结果已保存到: /root/autodl-tmp/SWaT-ICS_Anomaly_Detection/results/EvoAAE/detection_results/anomaly_detection.npz
 评估指标已保存到: /root/autodl-tmp/SWaT-ICS_Anomaly_Detection/results/EvoAAE/detection_results/metrics.json
 模型配置已保存到: /root/autodl-tmp/SWaT-ICS_Anomaly_Detection/results/EvoAAE/config/model_config.json
 数据集信息已保存到: /root/autodl-tmp/SWaT-ICS_Anomaly_Detection/results/EvoAAE/config/dataset_info.json
 模型对象已保存到: /root/autodl-tmp/SWaT-ICS_Anomaly_Detection/results/EvoAAE/model/evoaae_model.pkl
 执行摘要已保存到: /root/autodl-tmp/SWaT-ICS_Anomaly_Detection/results/EvoAAE/execution_summary.json

所有中间结果已保存完成！
保存位置: /root/autodl-tmp/SWaT-ICS_Anomaly_Detection/results/EvoAAE

调试信息:
  重构误差长度: 4495
  异常标签长度: 4495
  原始y_test长度: 4495
  匹配后y_test长度: 4495
 检测结果已保存到: /root/autodl-tmp/SWaT-ICS_Anomaly_Detection/results/EvoAAE/evoaae_detection_results.csv

================================================================================
训练和测试完成！
================================================================================

训练集大小: (99360, 51)
测试集大小: (89984, 51)
检测到的异常: 357 (7.94%)

Precision: 0.9972
Recall: 0.5050
F1-Score: 0.6704

所有结果已保存到 results/EvoAAE 目录
